# AI报告生成器

这是一个基于DeepSeek AI引擎的命令行报告生成工具，通过多线程并行处理大幅提高报告生成速度，支持Markdown和Word文档格式输出。

## 功能特点

- 🚀 **多线程并行生成**：使用多线程技术大幅提高报告生成速度
- 📝 **智能报告内容**：基于DeepSeek AI引擎生成专业、连贯的报告内容
- 📊 **自动目录生成**：智能生成报告目录结构和章节划分
- 📄 **支持Word导出**：自动将Markdown格式转换为Word文档
- 🌈 **精美命令行界面**：使用Rich库提供彩色、直观的命令行交互体验
- 💾 **自动保存与备份**：自动保存报告并提供中间结果备份
- 📏 **智能字数控制**：根据目标页数自动分配和控制各章节字数
- ⚡ **极简操作流程**：启动后直接输入主题和字数，无需复杂配置
- 📁 **简洁文件命名**：使用报告主题作为文件名，便于查找和管理

## 最新功能更新

- **简化文件命名**：生成的报告文件直接使用主题名称，方便管理和查找
- **简化用户界面**：启动程序后直接进入报告生成流程，输入主题和页数即可
- **智能字数控制系统**：根据报告总页数，自动计算并分配每个章节的目标字数
- **章节进度感知**：AI在生成章节时知道当前是第几章、总共有多少章，以及已生成多少内容
- **自适应章节权重**：不同类型的章节（如引言、正文、结论）会有不同的字数权重
- **结构化目录生成**：优化目录生成算法，创建更加清晰合理的章节结构

## 安装步骤

1. 克隆仓库：
```bash
git clone https://github.com/your-username/ai-report-generator.git
cd ai-report-generator
```

2. 创建并激活虚拟环境（推荐）：
```bash
# Windows
python -m venv .venv
.venv\Scripts\activate

# Linux/macOS
python3 -m venv .venv
source .venv/bin/activate
```

3. 安装依赖：
```bash
pip install -r requirements.txt
```

4. 安装Pandoc（用于Markdown转Word）：
   - 从[Pandoc官网](https://pandoc.org/installing.html)下载并安装

## 配置

使用前需要设置DeepSeek API密钥：

1. 设置环境变量（推荐）：
```bash
# Windows
set DEEPSEEK_API_KEY=您的API密钥

# Linux/macOS
export DEEPSEEK_API_KEY=您的API密钥
```

2. 或者在程序运行时输入API密钥

## 使用方法

1. 运行主程序：
```bash
python main.py
```

2. 输入基本信息：
   - 报告主题（您想要生成的报告内容）
   - 目标页数（系统会自动计算目标字数，通常每页约300字）

3. 程序会自动执行以下步骤：
   - 生成报告目录结构
   - 显示并保存目录到文件
   - 使用多线程模式并行生成所有章节内容
   - 显示实时生成进度
   - 自动保存为Markdown和Word文档
   - 可选择预览生成内容

4. 文件保存：
   - 生成的报告将保存在`reports`文件夹中
   - 文件名直接使用报告主题名称（空格将替换为下划线）
   - 目录文件：`TOC_报告主题.md`
   - Markdown报告：`报告主题.md`
   - Word文档：`报告主题.docx`

5. 报告生成完成后，您可以选择：
   - 继续生成新的报告
   - 退出程序

## 字数控制功能

AI报告生成器具有智能字数控制系统：

1. **自动字数分配**：
   - 系统会根据所需页数（一页约300字）计算总目标字数
   - 各章节会根据重要性获得不同权重的字数分配
   - 引言和结论通常略短，主体章节获得更多字数

2. **章节进度追踪**：
   - AI会了解当前正在生成第几章/共多少章
   - 会计算已生成的总字数，以调整后续章节的长度
   - 系统会告知AI目标字数，帮助AI控制输出长度

3. **结构平衡**：
   - 智能目录规划确保章节数量合适，不会过多导致篇幅不足
   - 主要章节和子章节比例均衡
   - 保持整体报告结构的一致性和连贯性

## 性能说明

- **线程数**：程序默认使用5个线程进行并行生成
- **批次大小**：默认每批处理3个章节，平衡速度和内容连贯性
- **处理模式**：使用混合批处理模式，在速度和质量之间取得良好平衡

## 注意事项

- 过多的并行请求可能触发API调用频率限制
- 要生成Word文档，必须安装Pandoc
- 可以通过创建`reference.docx`文件自定义Word文档样式
- 使用相同主题名生成新报告会覆盖旧文件

## 文件说明

- `main.py`：主程序，提供命令行界面
- `ai.py`：AI引擎接口，处理DeepSeek API通信
- `reports/`：生成的报告保存目录
- `requirements.txt`：依赖包列表 